// ---- Cylinder wellbore Region Gmsh scritp ----
// Creates a mesh with an inner structured-quad region and 
// an outer unstructured tri region
//
// Created 10/01/2016 by Omar Duran
// Labmec, State University of Campinas
// --------------------------------------------

// Settings
ExpertMode = 1;


Include "CadReservoir.geo";
Include "BoxReservoir.geo";
Include "BoxSideBurden.geo";
Include "BuildOmegas.geo";

Include "drill_producer.geo";
Include "drill_injector.geo";

Include "PhysicalEntities.geo";

well_lids = {};

well_p_bores = {};
well_p_regions = {};
well_p_v_regions = {};

well_i_bores = {};
well_i_regions = {};
well_i_v_regions = {};


geomechanicQ = 1;
dimension = 3;
nolinearQ = 0;
CADReservoirQ = 1;

xzQ = 0;
hexahedronsWQ = 1;
hexahedronsRQ = 0;
hexahedronsSBQ = 0;

If (nolinearQ == 1)
Mesh.ElementOrder = 2;
Mesh.SecondOrderLinear = 0;
EndIf

If (hexahedronsWQ == 1)
Mesh.Algorithm3D = 6 ;
Else
Mesh.Algorithm3D = 1 ;
EndIf


// Gmsh allows variables; these will be used to set desired
// element sizes at various Points
cl1 = 1;
cl2 = 0.1;
cl3 = 10.0;
cl4 = 100.0;
cl5 = 1000.0;

////////////////////////////////////////////////////////////////////////////
// reservoir region geometry
////////////////////////////////////////////////////////////////////////////

// reservoir box dimensions
x_length = 1000.0;
y_length = 1000.0;
z_length = 200.0;

////////////////////////////////////////////////////////////////////////////
// side-burden region geometry
////////////////////////////////////////////////////////////////////////////

// side-burden box dimensions
sb_x_length = 10000.0;
sb_y_length = 10000.0;
sb_z_length = 4000.0;

////////////////////////////////////////////////////////////////////////////
// well bore regions geometry
////////////////////////////////////////////////////////////////////////////

// mesh controls on wellbore region
alpha = 1.5;
n_radial = 10;
n_azimuthal = 5;
n_axial = 4; 

// Geometry well and wellbore region dimensions
radius = 0.1;
length = 100.0;
outer = 20;
angle = Pi/2.0;
beta = 0.0;


////////////////////////////////////////////////////////////////////////////
// reservoir rock
////////////////////////////////////////////////////////////////////////////
If(CADReservoirQ == 1)
Call ReservoirCAD;
Else
Call ReservoirBox;
EndIf

////////////////////////////////////////////////////////////////////////////
// side-burden rock
////////////////////////////////////////////////////////////////////////////
If (geomechanicQ == 1)
Call SideBurdenBox;
EndIf


////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
// Drilling wells 
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////////////////////
// Drill producer 1 
////////////////////////////////////////////////////////////////////////////

// new well data
well_index = 1;

// well location
wx = 0.0;
wy = 50.0;
wz = 10.0;
//Call DrillProducer;


////////////////////////////////////////////////////////////////////////////
// Drill injector 1 
////////////////////////////////////////////////////////////////////////////

// new well data
well_index = 2;

// well location
wx = 400.0;
wy = 350.0;
wz = -50.0;
//Call DrillInjector;

////////////////////////////////////////////////////////////////////////////
// Drill injector 2 
////////////////////////////////////////////////////////////////////////////

// new well data
well_index = 3;

// well location
wx = -400.0;
wy = -400.0;
wz = -50.0;
//Call DrillInjector;


////////////////////////////////////////////////////////////////////////////
// Drill injector 3 
////////////////////////////////////////////////////////////////////////////

// new well data
well_index = 4;

// well location
wx = -400.0;
wy = 350.0;
wz = -50.0;
//Call DrillInjector;

////////////////////////////////////////////////////////////////////////////
// Drill injector 4 
////////////////////////////////////////////////////////////////////////////

// new well data
well_index = 5;

// well location
wx = 400.0;
wy = -400.0;
wz = -50.0;
//Call DrillInjector;


////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
// Computational domain, boundaries:: Tagging physical entities
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////

Call DefineOmegas;
Call DrawBoundaries;



