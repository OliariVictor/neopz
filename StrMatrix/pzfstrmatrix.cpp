/* Generated by Together */

#include "pzfstrmatrix.h"
#include "pzfmatrix.h"
#include "pzcmesh.h"
#include "pzsubcmesh.h"

TPZMatrix * TPZFStructMatrix::CreateAssemble(TPZFMatrix &rhs){
    int neq = fMesh->NEquations();
    if(fMesh->FatherMesh()) {
      cout << "TPZFStructMatrix should not be called with CreateAssemble for a substructure mesh\n";
      return new TPZFMatrix();
    }
    TPZFMatrix *stiff = new TPZFMatrix(neq,neq,0.);
    rhs.Redim(neq,1);
    Assemble(*stiff,rhs);
    return stiff;
}

TPZMatrix * TPZFStructMatrix::Create(){
    int neq = fMesh->NEquations();
    if(fMesh->FatherMesh()) {
      TPZSubCompMesh *smesh = (TPZSubCompMesh *) fMesh;
      neq = smesh->NumInternalEquations();
    }
    return new TPZFMatrix(neq,neq,0.);
}
TPZFStructMatrix::TPZFStructMatrix(TPZCompMesh *mesh) : TPZStructMatrix(mesh)
{}
TPZStructMatrix * TPZFStructMatrix::Clone(){
    return new TPZFStructMatrix(fMesh);
}
